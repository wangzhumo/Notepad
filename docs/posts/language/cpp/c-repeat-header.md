---
title: C/C++中头文件被重复包含
lang: zh-CN
tags:
  - CPP 
date: 2021-10-25
---

## 头文件被重复引用

```c
#include文件的

demo.h
#include "x.h"
#include "y.h"

显然，上面是没用重复引用的,但是如果

x.h
#include "duplicate.h"

y.h
#include "duplicate.h"

```

在编译时,就会报错.

## 解决方法:

### endif

```c 
#ifndef _HEADERNAME_H
#define _HEADERNAME_H


...//(头文件内容)


#endif
```

**作用：**
相同的两个文件不会被重复包含。

**优点：**
- 受C/C++语言标准的支持，不受编译器的限制。
- 不仅仅局限于避免同一个文件被重复包含，也能避免内容完全相同的两个文件（或代码片段）被重复包含。

**缺点：**

- 如果不同头文件中的宏名恰好相同，可能就会导致你看到头文件明明存在，编译器却说找不到声明的情况。

- 由于编译器每次都需要打开头文件才能判定是否有重复定义，因此在编译大型项目时，#ifndef会使得编译时间相对较长。

### #pragma once

```c
#pragma once

//头文件主体
```

**作用：**
物理上的同一个文件不会被重复包含。

**优点：**
- 避免#ifndef中因为宏名相同导致的问题。
- 由于编译器不需要打开头文件就能判定是否有重复定义，因此在编译大型项目时，比#ifndef更快。

**缺点：**
- `#pragma once`只针对同一文件有效，对相同的两个文件（或代码片段）使用无效。

- `#pragma once`不受一些较老版本的编译器支持，一些支持了的编译器又打算去掉它，所以它的兼容性可能不够好。


